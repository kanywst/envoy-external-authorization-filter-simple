<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="516px" preserveAspectRatio="none" style="width:646px;height:516px;background:#FFFFFF;" version="1.1" viewBox="0 0 646 516" width="646px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="295" x="176.75" y="28.5352">Envoy/OPA Authorization Sequence Flow</text><rect fill="#FFFFFF" height="71.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="107.5" y="105.2871"/><rect fill="#FFFFFF" height="95.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="107.5" y="241.5293"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="107.5" y="366.7715"/><rect fill="#FFFFFF" height="64.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="386.5" y="176.9082"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="527.5" y="337.4609"/><rect fill="#FFFFFF" height="21.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="612.5" y="83.9766"/><rect fill="none" height="207.1289" style="stroke:#000000;stroke-width:1.5;" width="610.5" x="29" y="256.5293"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="17" x2="17" y1="73.9766" y2="480.6582"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="112" x2="112" y1="73.9766" y2="480.6582"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="391.5" x2="391.5" y1="73.9766" y2="480.6582"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="532.5" x2="532.5" y1="73.9766" y2="480.6582"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="617.5" x2="617.5" y1="73.9766" y2="480.6582"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="24" x="5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="12" y="63.0234">C</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="24" x="5" y="479.6582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="12" y="500.1934">C</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147" x="39" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="46" y="63.0234">Envoy Proxy (8080)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147" x="39" y="479.6582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="46" y="500.1934">Envoy Proxy (8080)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="323.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="330.5" y="63.0234">OPA (9191/gRPC)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="323.5" y="479.6582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="330.5" y="500.1934">OPA (9191/gRPC)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="469.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="476.5" y="63.0234">Echo Server (80)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="469.5" y="479.6582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="476.5" y="500.1934">Echo Server (80)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="24" x="605.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="612.5" y="63.0234">C</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="24" x="605.5" y="479.6582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="612.5" y="500.1934">C</text><rect fill="#FFFFFF" height="71.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="107.5" y="105.2871"/><rect fill="#FFFFFF" height="95.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="107.5" y="241.5293"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="107.5" y="366.7715"/><rect fill="#FFFFFF" height="64.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="386.5" y="176.9082"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="527.5" y="337.4609"/><rect fill="#FFFFFF" height="21.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="612.5" y="83.9766"/><polygon fill="#181818" points="128.5,101.2871,118.5,105.2871,128.5,109.2871,124.5,105.2871" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="122.5" x2="616.5" y1="105.2871" y2="105.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="343" x="134.5" y="100.5449">HTTP Request (GET /api/user, Authorization: Bearer ...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="117.5" x2="159.5" y1="134.5977" y2="134.5977"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="159.5" y1="134.5977" y2="147.5977"/><line style="stroke:#181818;stroke-width:1.0;" x1="118.5" x2="159.5" y1="147.5977" y2="147.5977"/><polygon fill="#181818" points="128.5,143.5977,118.5,147.5977,128.5,151.5977,124.5,147.5977" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="124.5" y="129.8555">1. HTTP Connection Manager</text><polygon fill="#181818" points="374.5,172.9082,384.5,176.9082,374.5,180.9082,378.5,176.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="112.5" x2="380.5" y1="176.9082" y2="176.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="119.5" y="172.166">2. ExtAuthz Filter: CheckRequest (gRPC)</text><path d="M269,189.9082 L269,214.9082 L513,214.9082 L513,199.9082 L503,189.9082 L269,189.9082 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M503,189.9082 L503,199.9082 L513,199.9082 L503,189.9082 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="275" y="207.4766">3. OPA executes policy (authz.rego)</text><polygon fill="#181818" points="128.5,237.5293,118.5,241.5293,128.5,245.5293,124.5,241.5293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="122.5" x2="390.5" y1="241.5293" y2="241.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="134.5" y="236.7871">4. CheckResponse (Allowed/Denied)</text><path d="M29,256.5293 L91,256.5293 L91,263.8398 L81,273.8398 L29,273.8398 L29,256.5293 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="207.1289" style="stroke:#000000;stroke-width:1.5;" width="610.5" x="29" y="256.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="44" y="270.0977">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="156" x="106" y="269.1641">[If Allowed (allow == true)]</text><line style="stroke:#181818;stroke-width:1.0;" x1="117.5" x2="159.5" y1="295.1504" y2="295.1504"/><line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="159.5" y1="295.1504" y2="308.1504"/><line style="stroke:#181818;stroke-width:1.0;" x1="118.5" x2="159.5" y1="308.1504" y2="308.1504"/><polygon fill="#181818" points="128.5,304.1504,118.5,308.1504,128.5,312.1504,124.5,308.1504" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="124.5" y="290.4082">5. Router Filter</text><polygon fill="#181818" points="515.5,333.4609,525.5,337.4609,515.5,341.4609,519.5,337.4609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="112.5" x2="521.5" y1="337.4609" y2="337.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="119.5" y="332.7188">6. Route to echo-server:80</text><polygon fill="#181818" points="128.5,362.7715,118.5,366.7715,128.5,370.7715,124.5,366.7715" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="122.5" x2="531.5" y1="366.7715" y2="366.7715"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="134.5" y="362.0293">7. HTTP Response (e.g., 200 OK)</text><polygon fill="#181818" points="605.5,392.082,615.5,396.082,605.5,400.082,609.5,396.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="112.5" x2="611.5" y1="396.082" y2="396.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="119.5" y="391.3398">8. HTTP Response</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="29" x2="639.5" y1="405.082" y2="405.082"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="155" x="34" y="415.7168">[If Denied (allow == false)]</text><polygon fill="#181818" points="605.5,451.6582,615.5,455.6582,605.5,459.6582,609.5,455.6582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="112.5" x2="611.5" y1="455.6582" y2="455.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="119.5" y="435.6055">5. HTTP 403 Forbidden</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="119.5" y="450.916">(failure_mode_allow: false)</text><!--SRC=[PP5VRvim5CNV_Ick-ZAG6aFwPqkHMYcZfAkc2XJoEAdou2QnocngJ9Rsqyysq4B62t1z_RlddAkvhX0ISP1lGPejOTdglLJydMak1UJusg8e45QL_4l85yYOqhpWDHCQxd7B1RTz3Qb7zHXO0t75KUX9FR7rCpSACYMFR-0jmaNedqswKjTbfNWtyvjvi5jdyKbBte6AlJG2rG6L1PaUmWhD3qmZn2I6sHqa4VpOR39OMnkD1kyXsK30QXwq3QhpgTa8lYDJ1aOfzKc98zWdE2593vxJZXrB8R1mQJqnmNQeR4xJ6FlvtTqqWWiAoL7RddTOyKgZYY3UO_7o8TIv7ej8HY9I8gHvIUlSq2ufsBZmY4MhiO5QLhmmuJBBfmftqYSfp3hPLtIOrDHcSGZUiZAxnJAuHy6nd0nD9yvPfU5n2ts_uTiFkBq5hLhq2PXd2EUQmbeQCQgtztcOH_2rFmGj0SqIPurROhG8NTlKjAry_EVkDn-yVAF3UWSlI7Vq72x24DAV_YajFw4bWof3YoDOdD3-5uELcM4Iw98Q1R1bvcIKGEmISBIhy19MKltcPOdYb_2sZ5UjmkS_iiHd1uZ6rwVpH4d-0G00]--></g></svg>