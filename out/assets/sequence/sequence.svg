<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="844px" preserveAspectRatio="none" style="width:645px;height:844px;background:#FFFFFF;" version="1.1" viewBox="0 0 645 844" width="645px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="428" x="109.75" y="28.5352">Envoy/OPA Authorization Sequence Flow (Logic Evaluation)</text><rect fill="#FFFFFF" height="102.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="82.5" y="120.5977"/><rect fill="#FFFFFF" height="95.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="82.5" y="585.2559"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="82.5" y="710.498"/><rect fill="#FFFFFF" height="362.416" style="stroke:#181818;stroke-width:1.0;" width="10" x="330.5" y="222.8398"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="542.5" y="681.1875"/><rect fill="#FFFFFF" height="36.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="611.5" y="83.9766"/><rect fill="none" height="319.1055" style="stroke:#000000;stroke-width:1.5;" width="344.5" x="268.5" y="237.8398"/><rect fill="none" height="144.2422" style="stroke:#000000;stroke-width:1.5;" width="267" x="278.5" y="355.082"/><rect fill="none" height="191.8184" style="stroke:#000000;stroke-width:1.5;" width="609.5" x="29" y="600.2559"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="17" x2="17" y1="73.9766" y2="809.0742"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="87" x2="87" y1="73.9766" y2="809.0742"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="335.5" x2="335.5" y1="73.9766" y2="809.0742"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="547.5" x2="547.5" y1="73.9766" y2="809.0742"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="616.5" x2="616.5" y1="73.9766" y2="809.0742"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="24" x="5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="12" y="63.0234">C</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="24" x="5" y="808.0742"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="12" y="828.6094">C</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="39" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="46" y="63.0234">Envoy Proxy</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="39" y="808.0742"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="46" y="828.6094">Envoy Proxy</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="288.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="295.5" y="63.0234">OPA Engine</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="288.5" y="808.0742"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="295.5" y="828.6094">OPA Engine</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="500.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="507.5" y="63.0234">Echo Server</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="500.5" y="808.0742"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="507.5" y="828.6094">Echo Server</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="24" x="604.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="611.5" y="63.0234">C</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="24" x="604.5" y="808.0742"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="611.5" y="828.6094">C</text><rect fill="#FFFFFF" height="102.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="82.5" y="120.5977"/><rect fill="#FFFFFF" height="95.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="82.5" y="585.2559"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="82.5" y="710.498"/><rect fill="#FFFFFF" height="362.416" style="stroke:#181818;stroke-width:1.0;" width="10" x="330.5" y="222.8398"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="542.5" y="681.1875"/><rect fill="#FFFFFF" height="36.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="611.5" y="83.9766"/><polygon fill="#181818" points="103.5,116.5977,93.5,120.5977,103.5,124.5977,99.5,120.5977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="615.5" y1="120.5977" y2="120.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="95" x="109.5" y="100.5449">HTTP Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="109.5" y="115.8555">(GET /api/user, Authorization: Bearer ...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="92.5" x2="134.5" y1="165.2188" y2="165.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="134.5" x2="134.5" y1="165.2188" y2="178.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="93.5" x2="134.5" y1="178.2188" y2="178.2188"/><polygon fill="#181818" points="103.5,174.2188,93.5,178.2188,103.5,182.2188,99.5,178.2188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="99.5" y="145.166">HTTP Connection Manager</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="99.5" y="160.4766">Extract headers &amp; path</text><polygon fill="#181818" points="318.5,218.8398,328.5,222.8398,318.5,226.8398,322.5,222.8398" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="87.5" x2="324.5" y1="222.8398" y2="222.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="214" x="94.5" y="202.7871">ExtAuthz: CheckRequest (gRPC)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="94.5" y="218.0977">input.attributes.request...</text><path d="M268.5,237.8398 L475.5,237.8398 L475.5,245.1504 L465.5,255.1504 L268.5,255.1504 L268.5,237.8398 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="319.1055" style="stroke:#000000;stroke-width:1.5;" width="344.5" x="268.5" y="237.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="283.5" y="251.4082">Policy Evaluation (Rego)</text><path d="M345,260.1504 L345,300.1504 L603,300.1504 L603,270.1504 L593,260.1504 L345,260.1504 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M593,260.1504 L593,270.1504 L603,270.1504 L593,260.1504 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="351" y="277.7188">Logic: OR (Short-circuit)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="351" y="293.0293">Any rule returning true grants access.</text><line style="stroke:#181818;stroke-width:1.0;" x1="340.5" x2="382.5" y1="327.082" y2="327.082"/><line style="stroke:#181818;stroke-width:1.0;" x1="382.5" x2="382.5" y1="327.082" y2="340.082"/><line style="stroke:#181818;stroke-width:1.0;" x1="341.5" x2="382.5" y1="340.082" y2="340.082"/><polygon fill="#181818" points="351.5,336.082,341.5,340.082,351.5,344.082,347.5,340.082" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="347.5" y="322.3398">1. Check</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="87" x="406.5" y="322.3398">default allow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="497.5" y="322.3398">(false)</text><path d="M278.5,355.082 L352.5,355.082 L352.5,362.3926 L342.5,372.3926 L278.5,372.3926 L278.5,355.082 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="144.2422" style="stroke:#000000;stroke-width:1.5;" width="267" x="278.5" y="355.082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="293.5" y="368.6504">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="131" x="367.5" y="367.7168">[Evaluate "allow" rules]</text><line style="stroke:#181818;stroke-width:1.0;" x1="340.5" x2="382.5" y1="393.7031" y2="393.7031"/><line style="stroke:#181818;stroke-width:1.0;" x1="382.5" x2="382.5" y1="393.7031" y2="406.7031"/><line style="stroke:#181818;stroke-width:1.0;" x1="341.5" x2="382.5" y1="406.7031" y2="406.7031"/><polygon fill="#181818" points="351.5,402.7031,341.5,406.7031,351.5,410.7031,347.5,406.7031" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="347.5" y="388.9609">Rule A: Check</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90" x="438.5" y="388.9609">Bearer Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="528.5" y="388.9609">?</text><line style="stroke:#181818;stroke-width:1.0;" x1="340.5" x2="382.5" y1="436.0137" y2="436.0137"/><line style="stroke:#181818;stroke-width:1.0;" x1="382.5" x2="382.5" y1="436.0137" y2="449.0137"/><line style="stroke:#181818;stroke-width:1.0;" x1="341.5" x2="382.5" y1="449.0137" y2="449.0137"/><polygon fill="#181818" points="351.5,445.0137,341.5,449.0137,351.5,453.0137,347.5,449.0137" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="347.5" y="431.2715">Rule B: Check</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="436.5" y="431.2715">Admin Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="527.5" y="431.2715">?</text><line style="stroke:#181818;stroke-width:1.0;" x1="340.5" x2="382.5" y1="478.3242" y2="478.3242"/><line style="stroke:#181818;stroke-width:1.0;" x1="382.5" x2="382.5" y1="478.3242" y2="491.3242"/><line style="stroke:#181818;stroke-width:1.0;" x1="341.5" x2="382.5" y1="491.3242" y2="491.3242"/><polygon fill="#181818" points="351.5,487.3242,341.5,491.3242,351.5,495.3242,347.5,491.3242" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="347.5" y="473.582">Rule C: Check</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="75" x="438.5" y="473.582">Public Path</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="513.5" y="473.582">?</text><path d="M345,511.3242 L345,551.3242 L552,551.3242 L552,521.3242 L542,511.3242 L345,511.3242 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M542,511.3242 L542,521.3242 L552,521.3242 L542,511.3242 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="351" y="528.8926">If</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="364" y="528.8926">any</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="393" y="528.8926">rule matches -&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="37" x="500" y="528.8926">Allow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="351" y="544.2031">Else -&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="402" y="544.2031">Deny</text><polygon fill="#181818" points="103.5,581.2559,93.5,585.2559,103.5,589.2559,99.5,585.2559" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="97.5" x2="334.5" y1="585.2559" y2="585.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106" x="109.5" y="580.5137">CheckResponse</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="219.5" y="580.5137">(Allowed/Denied)</text><path d="M29,600.2559 L91,600.2559 L91,607.5664 L81,617.5664 L29,617.5664 L29,600.2559 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="191.8184" style="stroke:#000000;stroke-width:1.5;" width="609.5" x="29" y="600.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="44" y="613.8242">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="183" x="106" y="612.8906">[Status: Allowed (allow == true)]</text><line style="stroke:#181818;stroke-width:1.0;" x1="92.5" x2="134.5" y1="638.877" y2="638.877"/><line style="stroke:#181818;stroke-width:1.0;" x1="134.5" x2="134.5" y1="638.877" y2="651.877"/><line style="stroke:#181818;stroke-width:1.0;" x1="93.5" x2="134.5" y1="651.877" y2="651.877"/><polygon fill="#181818" points="103.5,647.877,93.5,651.877,103.5,655.877,99.5,651.877" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="99.5" y="634.1348">Router Filter</text><polygon fill="#181818" points="530.5,677.1875,540.5,681.1875,530.5,685.1875,534.5,681.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="87.5" x2="536.5" y1="681.1875" y2="681.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114" x="94.5" y="676.4453">Forward Request</text><polygon fill="#181818" points="103.5,706.498,93.5,710.498,103.5,714.498,99.5,710.498" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="97.5" x2="546.5" y1="710.498" y2="710.498"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="109.5" y="705.7559">HTTP Response (200 OK)</text><polygon fill="#181818" points="604.5,735.8086,614.5,739.8086,604.5,743.8086,608.5,739.8086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="87.5" x2="610.5" y1="739.8086" y2="739.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="94.5" y="735.0664">HTTP Response</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="29" x2="638.5" y1="748.8086" y2="748.8086"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="182" x="34" y="759.4434">[Status: Denied (allow == false)]</text><polygon fill="#181818" points="604.5,780.0742,614.5,784.0742,604.5,788.0742,608.5,784.0742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="87.5" x2="610.5" y1="784.0742" y2="784.0742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140" x="94.5" y="779.332">HTTP 403 Forbidden</text><!--SRC=[XLHDRvj04BtpAqO-j1WrTlfnifHM3Y5jrLOWusCkQnZ3AcINxeSJvzTtTW4RqgZbO8kTDs_Ucvd5SDCW9E8WZyiqMyFQcbeg_imCbm9o_6rH50YtZNo4yAUiU079WJNMn-T1y1OofWmlUCk4WHlSSy5TI0Vjw3m6fY5kE0epEK_S-SnNXqp9f-Di4avzsCbAHCK5JgDvbrpKadIg0wfP4B32y0Cp274GmyLdI5OGHT-ssmmspeesKNGdmg_95fQivKkhKRsRUbx1DJA52XQBnJmeSSHuPa-2f6VttB4K0WlViLzCi0hLdKYUZ28yrCXAL1hUGCjCxHesRN6lgoDCdLpAT93d5SGr5lSz0C9gayLpfv-Brfe5CqRndJMe5wg3aEAnu6GaE0qg9MqBcMnuSHoD4C8DLd8U03r24bBngZOWzvG2_HD5Vl0hI3SGvgJTN1HS5PORadD2hSKHbALbKcYi8f4L66KHAaN3qi2A0hLUU3YAqXVpB_udxTs_NtIcgMQ9UsOR0woXtOiY2FUiqTWfRQHi1nC8Cm-P-Uhwf6UWt3XDwzM9jn_lLjwZYA8lh-Elp_Xr-S35V-3n6PxP7RMOReMf1pZP_MT_l-yfZuaZcVGDV62cg56x0bI-ity29zI4BdA3BcNQK5Sg86d3wlSRf5kwaUYQwEcmN58ontAouEbamHcrFZVCMBs2FWb2tsYuklAJxKOnN8IDf5LKSCiR-Zj7SgVYLgf7fihp7VJnwQgwazDxxb_pmKT_WJiN47wul8Jqn_mbIVw291bK44dyWkHl0UZwEXZkkZFoEzezRoi-VLS-NNu4yhVZPUaMv1LY6iaV]--></g></svg>